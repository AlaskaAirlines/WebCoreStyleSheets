// Copyright (c) Alaska Air. All right reserved. Licensed under the Apache-2.0 license
// See LICENSE in the project root for license information.

// ---------------------------------------------------------------------

/*
  Base essentials mixin â€“ shared styles across all themes, 
  excluding legacy themes such as Auro Classic.
  
  Accepts a map of CSS custom properties for theme-specific values
*/

// sass-lint:disable mixins-before-declarations variable-for-property no-vendor-prefixes

@import '../libSupport/manageScope';
@import '../core';
@import '../themes/index';

// Define the $paragraph variable with default value
$paragraph: null !default;

/// Function to create CSS var with SCSS fallback from variable name string
/// @param {String} $var-name - Design token name (without $ or --)
/// @param {*} $fallback-value - The actual SCSS variable value to use as fallback
/// @return {String} - CSS var() with SCSS fallback
@function css-var($var-name, $fallback-value) {
  $css-var: '--' + $var-name;
  @return var(#{$css-var}, #{$fallback-value});
}

/// Function to create CSS var with SCSS fallback from theme props
/// @param {Map} $theme-props - Theme map containing property variable name mappings
/// @param {String} $prop-name - Property name key in the theme map
/// @return {String} - CSS var() with SCSS fallback
@function theme-css-var($theme-props, $prop-name) {
  $prop-list: map-get($theme-props, $prop-name);
  @return css-var(nth($prop-list, 1), nth($prop-list, 2));
}

/// Mixin for base essentials
/// @param {Map} $theme-props - Theme map containing property variable name mappings
@mixin essentials-base($theme-props) {
  
  /// Baseline HTML setting to establish box-model and default font size.
  #{$sym}#{$prefix}html#{$scope} {
    box-sizing: border-box;
    font-size: theme-css-var($theme-props, 'font-size');
    -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
  }

  /// Set baseline type settings for `body` element or with the use of the `.baseType` selector.
  #{$scope}#{$sym}#{$prefix}body,
  #{$scope}.#{$prefix}baseType {
    margin: 0;
    color: theme-css-var($theme-props, 'text-color');
    font-family: theme-css-var($theme-props, 'font-family');
    font-size: theme-css-var($theme-props, 'font-size');
    font-weight: theme-css-var($theme-props, 'font-weight');
    line-height: theme-css-var($theme-props, 'line-height');
    
    @if map-has-key($theme-props, 'letter-spacing') {
      letter-spacing: theme-css-var($theme-props, 'letter-spacing');
    }
    
    font-variant-ligatures: no-common-ligatures;
  }

  /// Sets standard `margin` for all paragraph style content
  #{$scope}.#{$prefix}baseParagraph {
    margin: 0 0 1rem;
    line-height: theme-css-var($theme-props, 'line-height');

    .#{$prefix}hyperlink {
      text-decoration: underline;
    }
  }

  /// Baseline hyperlink styles as mirrored in auro-hyperlink web component
  #{$scope}.#{$prefix}hyperlink {
    text-decoration: underline;
    color: theme-css-var($theme-props, 'hyperlink-color');

    &:visited {
      color: theme-css-var($theme-props, 'hyperlink-color');
    }

    &--nav {
      display: block;
      text-decoration: none;

      &:not(.is-touching) {
        &:hover {
          text-decoration: underline !important;
        }
      }
    }

    &--ondark {
      color: theme-css-var($theme-props, 'hyperlink-inverse-color');

      &:not(.is-touching) {
        &:hover {
          color: theme-css-var($theme-props, 'hyperlink-inverse-hover-color');
        }
      }

      &:visited {
        color: theme-css-var($theme-props, 'hyperlink-inverse-color');
      }
    }

    &:not(.is-touching) {
      &:hover {
        text-decoration: none;
        color: theme-css-var($theme-props, 'hyperlink-hover-color');
      }
    }
  }

  /// Default setting for all `<img />` tags
  #{$scope}#{$sym}#{$prefix}img {
    max-width: 100%;
  }

  /// Legal copy, disclaimers, and footnotes
  #{$scope}#{$sym}#{$prefix}small,
  #{$scope}.#{$prefix}type--small {
    font-size: theme-css-var($theme-props, 'small-font-size');
    font-weight: theme-css-var($theme-props, 'small-font-weight');
    line-height: theme-css-var($theme-props, 'small-line-height');
    
    @if map-has-key($theme-props, 'small-letter-spacing') {
      letter-spacing: theme-css-var($theme-props, 'small-letter-spacing');
    }
  }

  /// Paragraph element margin (conditional)
  #{$scope}#{$sym}#{$prefix}p {
    @if $paragraph {
      margin: 0 0 1rem;
      line-height: theme-css-var($theme-props, 'paragraph-line-height');
    }
  }

  /// Fine print text
  #{$scope}.#{$prefix}fineprint {
    font-family: theme-css-var($theme-props, 'font-family');
    font-size: theme-css-var($theme-props, 'small-font-size');
    font-weight: theme-css-var($theme-props, 'small-font-weight');
    line-height: theme-css-var($theme-props, 'small-line-height');
    color: theme-css-var($theme-props, 'muted-text-color');
    
    @if map-has-key($theme-props, 'small-letter-spacing') {
      letter-spacing: theme-css-var($theme-props, 'small-letter-spacing');
    }
  }
}
